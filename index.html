<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººå·¥ä½œåŠ å ±åè¡¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            /* å°‡åœ–ç‰‡ä½œç‚ºèƒŒæ™¯ï¼Œä¸¦åŠ ä¸ŠåŠé€æ˜çš„ç´«è‰²æ¼¸å±¤é®ç½©ä»¥ç¢ºä¿æ–‡å­—æ˜“è®€æ€§ */
            background: linear-gradient(-45deg, rgba(59, 7, 100, 0.85), rgba(107, 33, 168, 0.85), rgba(147, 51, 234, 0.85), rgba(217, 70, 239, 0.85)),
                        url('https://raw.githubusercontent.com/linmenggann/TrainingWorkshop3/main/DSC00045.jpg');
            background-size: 400% 400%, cover;
            background-position: 0% 50%, center;
            background-attachment: fixed, fixed;
            background-repeat: no-repeat;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%, center; }
            50% { background-position: 100% 50%, center; }
            100% { background-position: 0% 50%, center; }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        .glass-input {
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        .glass-input:focus {
            background: #ffffff;
            box-shadow: 0 0 0 4px rgba(217, 70, 239, 0.4);
            transform: translateY(-2px);
        }

        /* æ¼‚æµ®å‹•ç•«ç‰¹æ•ˆ */
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* è‡ªè¨‚å–®é¸æŒ‰éˆ•æ¨£å¼éš±è— */
        input[type="radio"]:checked + div {
            background-color: #d946ef; /* Fuchsia 500 */
            color: white;
            border-color: #d946ef;
            box-shadow: 0 4px 15px rgba(217, 70, 239, 0.5);
            transform: scale(1.05);
        }
    </style>
</head>
<body class="min-h-screen text-white relative overflow-x-hidden flex flex-col justify-center items-center py-12 px-4">

    <!-- èƒŒæ™¯è£é£¾çƒ -->
    <div class="absolute top-[-10%] left-[-10%] w-96 h-96 bg-fuchsia-500 rounded-full mix-blend-multiply filter blur-[128px] opacity-70 animate-pulse"></div>
    <div class="absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-purple-600 rounded-full mix-blend-multiply filter blur-[128px] opacity-70 animate-pulse" style="animation-delay: 2s;"></div>

    <!-- ä¸»è¦å…§å®¹å€å¡Š -->
    <div class="max-w-4xl w-full glass-panel rounded-3xl p-6 md:p-10 z-10 relative">
        
        <!-- æ¨™é¡Œ -->
        <div class="text-center mb-10 floating">
            <h1 class="text-4xl md:text-5xl font-black mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-pink-300 to-fuchsia-300 drop-shadow-lg">
                ğŸš€ æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººå·¥ä½œåŠ ğŸ“
            </h1>
            <p class="text-lg md:text-xl text-purple-100 font-medium tracking-wide">
                æ­¡è¿å ±åï¼ä¸€èµ·æ¢ç´¢æ•™å­¸çš„ç„¡é™å¯èƒ½ âœ¨
            </p>
        </div>

        <!-- æ´»å‹•è³‡è¨Šå¡ç‰‡ -->
        <div class="bg-black/30 rounded-2xl p-6 mb-10 flex flex-col md:flex-row justify-between items-center gap-6 border border-white/10 hover:bg-black/40 transition-colors">
            <div class="flex items-center gap-4 w-full md:w-1/3 justify-center md:justify-start">
                <div class="text-4xl">ğŸ“…</div>
                <div>
                    <div class="text-sm text-purple-300">æ—¥æœŸ</div>
                    <div class="text-xl font-bold">2026/01/25</div>
                </div>
            </div>
            <div class="hidden md:block w-px h-12 bg-white/20"></div>
            <div class="flex items-center gap-4 w-full md:w-1/3 justify-center">
                <div class="text-4xl">â°</div>
                <div>
                    <div class="text-sm text-purple-300">æ™‚é–“</div>
                    <div class="text-xl font-bold">9:00 ~ 16:00</div>
                </div>
            </div>
            <div class="hidden md:block w-px h-12 bg-white/20"></div>
            <div class="flex items-center gap-4 w-full md:w-1/3 justify-center md:justify-end">
                <div class="text-4xl">ğŸ“</div>
                <div class="text-center md:text-left">
                    <div class="text-sm text-purple-300">åœ°é»</div>
                    <div class="text-lg font-bold leading-tight">å¥‡ç¾é†«é™¢ç¬¬äº”é†«ç™‚å¤§æ¨“<br>6æ¨“563æœƒè­°å®¤</div>
                </div>
            </div>
        </div>

        <!-- å ±åè¡¨å–® -->
        <form id="registrationForm" class="space-y-6">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- å§“å -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">ğŸ‘¤ å§“å</label>
                    <input type="text" name="name" required placeholder="è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å" 
                        class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 outline-none border-2 border-transparent">
                </div>

                <!-- æ©Ÿæ§‹å -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">ğŸ¥ æ©Ÿæ§‹å</label>
                    <input type="text" name="organization" required placeholder="è«‹è¼¸å…¥æ‚¨æ‰€å±¬çš„æ©Ÿæ§‹åç¨±" 
                        class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 outline-none border-2 border-transparent">
                </div>

                <!-- è·ç¨± -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">ğŸ’¼ è·ç¨±</label>
                    <input type="text" name="jobTitle" required placeholder="ä¾‹å¦‚ï¼šä¸»æ²»é†«å¸«ã€è­·ç†é•·..." 
                        class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 outline-none border-2 border-transparent">
                </div>

                <!-- è² è²¬çš„è·é¡ -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">ğŸ“‹ è² è²¬çš„è·é¡</label>
                    <div class="relative">
                        <select name="category" required class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 appearance-none outline-none border-2 border-transparent cursor-pointer font-medium">
                            <option value="" disabled selected>ğŸ‘‰ è«‹é¸æ“‡ä¸‹æ‹‰å¼é¸å–®</option>
                            <option value="è—¥äº‹">ğŸ’Š è—¥äº‹</option>
                            <option value="é†«äº‹æ”¾å°„">â˜¢ï¸ é†«äº‹æ”¾å°„</option>
                            <option value="é†«äº‹æª¢é©—">ğŸ”¬ é†«äº‹æª¢é©—</option>
                            <option value="è­·ç†">ğŸ©º è­·ç†</option>
                            <option value="ç‡Ÿé¤Š">ğŸ¥— ç‡Ÿé¤Š</option>
                            <option value="å‘¼å¸æ²»ç™‚">ğŸ« å‘¼å¸æ²»ç™‚</option>
                            <option value="è½åŠ›">ğŸ‘‚ è½åŠ›</option>
                            <option value="ç‰©ç†æ²»ç™‚">ğŸƒâ€â™‚ï¸ ç‰©ç†æ²»ç™‚</option>
                            <option value="è·èƒ½æ²»ç™‚">ğŸ§© è·èƒ½æ²»ç™‚</option>
                            <option value="è‡¨åºŠå¿ƒç†">ğŸ§  è‡¨åºŠå¿ƒç†</option>
                            <option value="èªè¨€æ²»ç™‚">ğŸ—£ï¸ èªè¨€æ²»ç™‚</option>
                            <option value="å…¶ä»–">âœ¨ å…¶ä»–</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-600">
                            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å–®é¸é¡Œå€å¡Š -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 bg-black/10 rounded-2xl p-6 border border-white/5 mt-4">
                
                <!-- è¨ˆç•«ä¸»æŒäºº -->
                <div>
                    <label class="block text-sm font-bold mb-4 text-purple-100 text-center md:text-left">ğŸ‘‘ æ‚¨ç›®å‰æ˜¯å¦æ“”ä»»æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººï¼Ÿ</label>
                    <div class="flex gap-4 justify-center md:justify-start">
                        <label class="cursor-pointer relative flex-1">
                            <input type="radio" name="isDirector" value="æ˜¯" class="peer sr-only" required>
                            <div class="w-full text-center py-3 rounded-xl border-2 border-white/30 text-white font-bold transition-all duration-300 hover:bg-white/10">
                                âœ… æ˜¯çš„
                            </div>
                        </label>
                        <label class="cursor-pointer relative flex-1">
                            <input type="radio" name="isDirector" value="å¦" class="peer sr-only">
                            <div class="w-full text-center py-3 rounded-xl border-2 border-white/30 text-white font-bold transition-all duration-300 hover:bg-white/10">
                                âŒ å¦ï¼Œå°šæœª
                            </div>
                        </label>
                    </div>
                </div>

                <!-- åƒèˆ‡æ–¹å¼ -->
                <div>
                    <label class="block text-sm font-bold mb-4 text-purple-100 text-center md:text-left">ğŸ’» æ‚¨é è¨ˆä»¥ä½•ç¨®æ–¹å¼åƒèˆ‡ï¼Ÿ</label>
                    <div class="flex gap-4 justify-center md:justify-start">
                        <label class="cursor-pointer relative flex-1">
                            <input type="radio" name="participation" value="å¯¦é«”" class="peer sr-only" required>
                            <div class="w-full text-center py-3 rounded-xl border-2 border-white/30 text-white font-bold transition-all duration-300 hover:bg-white/10">
                                ğŸ¢ å¯¦é«”åƒèˆ‡
                            </div>
                        </label>
                        <label class="cursor-pointer relative flex-1">
                            <input type="radio" name="participation" value="ç·šä¸Š" class="peer sr-only">
                            <div class="w-full text-center py-3 rounded-xl border-2 border-white/30 text-white font-bold transition-all duration-300 hover:bg-white/10">
                                ğŸŒ ç·šä¸Šåƒèˆ‡
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                <!-- Email -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">âœ‰ï¸ Email</label>
                    <input type="email" name="email" required placeholder="example@email.com" 
                        class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 outline-none border-2 border-transparent">
                </div>

                <!-- è¯ç¹«é›»è©± -->
                <div>
                    <label class="block text-sm font-bold mb-2 ml-1 text-purple-100">ğŸ“± è¯ç¹«é›»è©±</label>
                    <input type="tel" name="phone" required placeholder="09XX-XXX-XXX æˆ– å¸‚è©±" 
                        class="w-full glass-input text-gray-800 rounded-xl px-4 py-3 outline-none border-2 border-transparent">
                </div>
            </div>

            <!-- é€å‡ºæŒ‰éˆ• -->
            <div class="pt-8 pb-4">
                <button type="submit" class="w-full md:w-2/3 mx-auto block bg-gradient-to-r from-pink-500 to-fuchsia-600 hover:from-pink-400 hover:to-fuchsia-500 text-white text-xl font-bold py-4 px-8 rounded-full shadow-[0_0_20px_rgba(217,70,239,0.5)] transition-all duration-300 transform hover:scale-105 active:scale-95">
                    ğŸ‰ ç«‹å³é€å‡ºå ±å ğŸ‰
                </button>
            </div>
        </form>
    </div>

    <!-- é å°¾è¯çµ¡è³‡è¨Š -->
    <footer class="mt-12 text-center text-purple-200 z-10 glass-panel px-8 py-4 rounded-full text-sm">
        <p class="mb-1 font-bold tracking-wider">ğŸ¢ ä¸»è¾¦å–®ä½ï¼šå¥‡ç¾é†«é™¢æ•™å­¸éƒ¨</p>
        <p class="flex items-center justify-center gap-2">
            <span>ğŸ‘¤ è¯çµ¡äººï¼šé™³å¤§é ­</span>
            <span class="mx-2">|</span>
            <span>ğŸ“ è¯ç¹«é›»è©±ï¼š06-281-2811 åˆ†æ©Ÿ 57112233</span>
        </p>
    </footer>

    <!-- æˆåŠŸå½ˆå‡ºè¦–çª— (é è¨­éš±è—) -->
    <div id="successModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full mx-4 text-center transform scale-90 transition-transform duration-300" id="modalContent">
            <div class="text-6xl mb-4 floating">ğŸŠ</div>
            <h2 class="text-2xl font-black text-purple-800 mb-2">å ±åæˆåŠŸï¼</h2>
            <p class="text-gray-600 font-medium mb-6">æˆ‘å€‘å·²ç¶“æ”¶åˆ°æ‚¨çš„è³‡æ–™ï¼ŒæœŸå¾…åœ¨å·¥ä½œåŠèˆ‡æ‚¨ç›¸è¦‹ï¼</p>
            <button onclick="closeModal()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full w-full transition-colors">
                å¤ªæ£’äº†ï¼ğŸ‘
            </button>
        </div>
    </div>

    <script>
        const form = document.getElementById('registrationForm');
        const modal = document.getElementById('successModal');
        const modalContent = document.getElementById('modalContent');
        
        // å·²ç¶“æ›¿æ›ç‚ºæ‚¨çš„ Google Apps Script URL
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwIcW6g6na6mc7Pbfskw4LATqPnsS6b6W97YA85PoLxrEnXepVunsghu07aeASW5R-5-w/exec';

        // æª¢æŸ¥æ˜¯å¦é¡æ»¿ (é™é¡ 4 å)
        const sheetId = '12PkIByUr-lJmVOwj854h6YS6QqG8yqsIlhIPRy00HJU';
        const checkUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent('å·¥ä½œåŠå ±åè³‡æ–™')}`;

        window.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch(checkUrl);
                const text = await response.text();
                // æ“·å– JSON è³‡æ–™
                const jsonString = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
                const data = JSON.parse(jsonString);
                
                let total = 0;
                data.table.rows.forEach(row => {
                    if (row.c && row.c[0] && row.c[1] && row.c[1].v) total++;
                });

                // å¦‚æœäººæ•¸å¤§æ–¼æˆ–ç­‰æ–¼ 4 äººï¼Œè§¸ç™¼é¡æ»¿é–å®šæ©Ÿåˆ¶
                if (total >= 4) {
                    const submitBtn = form.querySelector('button[type="submit"]');
                    submitBtn.innerHTML = 'ğŸš« æœ¬æ´»å‹•å·²é¡æ»¿';
                    submitBtn.disabled = true;
                    submitBtn.className = 'w-full md:w-2/3 mx-auto block bg-gray-600 text-gray-300 text-xl font-bold py-4 px-8 rounded-full cursor-not-allowed opacity-80';
                    
                    // æ¨™é¡Œå€å¡Šé¡¯ç¤ºé¡æ»¿è­¦å‘Š
                    const headerDiv = document.querySelector('.floating');
                    const warningMsg = document.createElement('div');
                    warningMsg.innerHTML = '<span class="inline-block mt-4 bg-red-600/90 text-white border-2 border-red-300 px-6 py-2 rounded-full font-bold text-lg shadow-[0_0_15px_rgba(220,38,38,0.8)] animate-pulse">âš ï¸ ç›®å‰å ±åäººæ•¸å·²é”ä¸Šé™ (4å)ï¼Œåœæ­¢å—ç†å ±å</span>';
                    headerDiv.appendChild(warningMsg);

                    // ç¦ç”¨æ‰€æœ‰è¼¸å…¥æ¡†ï¼Œä¸è®“ä½¿ç”¨è€…ç¹¼çºŒå¡«å¯«
                    const inputs = form.querySelectorAll('input, select');
                    inputs.forEach(input => {
                        input.disabled = true;
                        input.classList.add('opacity-50', 'cursor-not-allowed', 'bg-gray-200');
                    });
                }
            } catch (error) {
                console.error('æª¢æŸ¥äººæ•¸å¤±æ•—:', error);
            }
        });

        form.addEventListener('submit', function(e) {
            e.preventDefault(); // é˜²æ­¢ç•«é¢é‡æ•´
            
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;
            
            // è®Šæ›´æŒ‰éˆ•ç‹€æ…‹ï¼Œé¿å…ä½¿ç”¨è€…é‡è¤‡é»æ“Šé€å‡º
            submitBtn.innerHTML = 'â³ è³‡æ–™å‚³é€ä¸­...';
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-75', 'cursor-not-allowed');

            // å‚³é€è³‡æ–™åˆ° Google Apps Script
            // åŠ å…¥ mode: 'no-cors' è§£æ±ºè·¨ç¶²åŸŸ(CORS)çš„ Failed to fetch éŒ¯èª¤
            fetch(scriptURL, { method: 'POST', body: new FormData(form), mode: 'no-cors' })
                .then(response => {
                    // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                    submitBtn.innerHTML = originalBtnText;
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                    
                    // é¡¯ç¤º Modal å‹•ç•«
                    modal.classList.remove('hidden');
                    // ç¨å¾®å»¶é²ä»¥è§¸ç™¼ CSS å‹•ç•«
                    setTimeout(() => {
                        modal.classList.remove('opacity-0');
                        modal.classList.add('opacity-100');
                        modalContent.classList.remove('scale-90');
                        modalContent.classList.add('scale-100');
                    }, 10);
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    submitBtn.innerHTML = originalBtnText;
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                    alert('ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
                });
        });

        function closeModal() {
            // éš±è— Modal å‹•ç•«
            modal.classList.remove('opacity-100');
            modal.classList.add('opacity-0');
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-90');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                form.reset(); // æ¸…ç©ºè¡¨å–®
            }, 300);
        }
    </script>
</body>
</html>
